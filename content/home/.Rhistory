library(tidyverse)
library(openxlsx)
raw <- read.xlsx("C:\\Users\\isaac\\Desktop\\yaniv.xlsx",
detectDates = T)
## Clean data
df <- raw %>%
mutate(game_id = case_when(
game_in_date == 1 ~ as.character(date),
game_in_date > 1 ~ paste0(date, " (", game_in_date, ")")) %>%
factor()) %>%
group_by(game_id) %>%
rename(i_cum = i,
r_cum = r) %>%
mutate(i_minus_r = i_cum - r_cum,
i_hand = i_cum - lag(i_cum, 1, default = 0),
r_hand = r_cum - lag(r_cum, 1, default = 0),
result = i_cum >= 100 | r_cum >= 100,
winner = case_when(i_hand == 0 ~ "Isaac",
r_hand == 0 ~ "Rebecca"),
loser = case_when(i_hand > 0 ~ "Isaac",
r_hand > 0 ~ "Rebecca")) %>%
ungroup()
df
## First-move Advantage
df %>%
group_by(game_id) %>%
mutate(winner_lag = lag(winner, 1)) %>%
ungroup() %>%
count(winner_lag, winner) %>%
mutate(prop = n / sum(n))
df %>%
group_by(game_id) %>%
mutate(winner_lag = lag(winner, 1)) %>%
ungroup()
## First-move Advantage
df %>%
group_by(game_id) %>%
mutate(winner_lag = lag(winner, 1)) %>%
ungroup() %>%
drop_na(winner_lag) %>%
count(winner_lag, winner) %>%
mutate(prop = n / sum(n))
## First-move Advantage
df %>%
group_by(game_id) %>%
mutate(winner_lag = lag(winner, 1)) %>%
ungroup() %>%
drop_na(winner_lag, winner) %>%
count(winner_lag, winner) %>%
mutate(prop = n / sum(n))
## First-move Advantage
df %>%
group_by(game_id) %>%
mutate(winner_lag = lag(winner, 1)) %>%
ungroup() %>%
drop_na(winner_lag, winner) %>%
count(winner_lag, winner) %>%
group_by(winner_lag) %>%
mutate(prop = n / sum(n))
df %>%
group_by(game_id) %>%
mutate(winner_lag = lag(winner, 1)) %>%
ungroup() %>%
drop_na(winner_lag, winner) %>%
count(winner_lag, winner)
## First-move Advantage
df %>%
group_by(game_id) %>%
mutate(winner_lag = lag(winner, 1)) %>%
ungroup() %>%
drop_na(winner_lag, winner) %>%
count(winner_lag, winner) %>%
mutate(repeat_winner = winner == winner_lag,
switch_winner = winner != winner_lag)
## First-move Advantage
df %>%
group_by(game_id) %>%
mutate(winner_lag = lag(winner, 1)) %>%
ungroup() %>%
drop_na(winner_lag, winner) %>%
count(winner_lag, winner) %>%
mutate(repeat_winner = winner == winner_lag,
switch_winner = winner != winner_lag) %>%
group_by(repeat_winner, switch_winner) %>%
summarize(games_won = sum(n))
## First-move Advantage
df %>%
group_by(game_id) %>%
mutate(winner_lag = lag(winner, 1)) %>%
ungroup() %>%
drop_na(winner_lag, winner) %>%
count(winner_lag, winner) %>%
mutate(repeat_winner = winner == winner_lag,
switch_winner = winner != winner_lag) %>%
group_by(repeat_winner, switch_winner) %>%
summarize(games_won = sum(n), .groups = "drop") %>%
mutate(pct = games_won / sum(games_won))
